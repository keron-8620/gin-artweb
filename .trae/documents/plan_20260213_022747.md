# 完成 user_usecase_test.go 单元测试

## 测试方法规划

### 1. 基础方法测试
- **TestGetRole** - 测试获取用户关联的角色
- **TestFindUserByID** - 测试根据 ID 查询用户
- **TestFindUserByName** - 测试根据用户名查询用户
- **TestListUser** - 测试查询用户列表
- **TestListLoginRecord** - 测试查询登录记录列表

### 2. 核心功能测试
- **TestCreateUser** - 测试创建用户
- **TestUpdateUserByID** - 测试更新用户
- **TestDeleteUserByID** - 测试删除用户
- **TestLogin** - 测试用户登录（成功场景）
- **TestLoginWithFailedPassword** - 测试用户登录（密码失败场景）
- **TestPatchPassword** - 测试修改密码
- **TestRefreshTokens** - 测试刷新令牌

### 3. 错误处理测试
- **TestGetRoleWithContextError** - 测试上下文错误处理
- **TestCreateUserWithContextError** - 测试上下文错误处理
- **TestUpdateUserByIDWithContextError** - 测试上下文错误处理
- **TestDeleteUserByIDWithContextError** - 测试上下文错误处理
- **TestFindUserByIDWithContextError** - 测试上下文错误处理
- **TestFindUserByNameWithContextError** - 测试上下文错误处理
- **TestListUserWithContextError** - 测试上下文错误处理
- **TestListLoginRecordWithContextError** - 测试上下文错误处理
- **TestLoginWithContextError** - 测试上下文错误处理
- **TestPatchPasswordWithContextError** - 测试上下文错误处理
- **TestRefreshTokensWithContextError** - 测试上下文错误处理

## 测试实现要点

1. **参考之前的测试风格** - 遵循 button_usecase_test.go 和 role_usecase_test.go 的测试结构和模式
2. **测试前准备** - 为用户测试创建角色数据，因为用户需要关联角色
3. **断言验证** - 验证返回结果、错误状态、密码哈希等
4. **特殊场景测试** - 测试登录失败、密码强度验证等特殊场景
5. **Casbin 权限** - 虽然用户用例不直接处理 Casbin 策略，但登录时会验证角色权限

## 实现步骤

1. 编写基础方法测试用例
2. 编写核心功能测试用例
3. 编写错误处理测试用例
4. 编写特殊功能测试用例
5. 运行测试验证所有测试通过